opcua:
  configuration:
    enabled: true
    name: akri-opcua
    capacity: 1
    discoveryDetails:
      # discoveryUrls is a list of DiscoveryUrls for OPC UA servers
      discoveryUrls:
        - "opc.tcp://192.168.49.151:4840"
        - "opc.tcp://192.168.49.198:62548"
        - "opc.tcp://192.168.49.197:62548"
        - "opc.tcp://192.168.49.173:62548"
        - "opc.tcp://192.168.49.196:62548"
        - "opc.tcp://192.168.49.195:62548"
        - "opc.tcp://192.168.49.194:62548"
        - "opc.tcp://192.168.49.193:62548"
        - "opc.tcp://192.168.49.192:62548"
        - "opc.tcp://192.168.49.172:62548"
        - "opc.tcp://192.168.49.191:62548"
        - "opc.tcp://192.168.49.190:62548"
        - "opc.tcp://192.168.49.171:62548"

      applicationNames:
        action: Include
        items: ["SIMATIC.S7-1200.OPC-UA.Application:PLC_1"]
    pod:
      restartPolicy: Always
      enabled: true
      volumes:
        - name: devices-config-volume
          configMap:
            name: opc-teka-aircube-1-global-devices-config
            items:
              - key: config.json
                path: config.json
        - name: dataservice-machine-config
          configMap:
            name: opc-teka-aircube-1-app-config
            items:
              - key: config.json
                path: config.json
        - name: devices-data-volume
          hostPath:
            path: /var/device/data/
        - name: devices-kube-volume
          hostPath:
            path: /var/kube/config.yaml
      imagePullSecrets:
        - name: regcred

    brokerPod1:
      name: fusionopcuadataservice
      image:
        repository: docker.io/ibn40/fusionopcuadataservice
        tag: latest
        pullPolicy: Always
      env: 
        IFF_AGENT_URL: "127.0.0.1"
        IFF_AGENT_PORT: "7070"
        OPC_USERNAME: ""
        OPC_PASSWORD: ""
      volumeMounts:
        - name: dataservice-machine-config
          mountPath: /resources/config.json
          subPath: config.json

    brokerPod2:
      name: oisp-iot-agent
      image:
        repository: docker.io/ibn40/iff-iot-agent
        tag: v0.0.2
        pullPolicy: Always
      env:
        ACTIVATION_MODE: "secret"
      volumeMounts:
        - name: devices-config-volume
          mountPath: /volume/config
        - name: devices-data-volume
          mountPath: /volume/data
        - name: devices-kube-volume
          mountPath: /root/.kube/config
      securityContext:
        privileged: true
        capabilities:
          drop: ["ALL"]
      ports:
        - containerPort: 41234
          hostPort: 41234
        - containerPort: 7070
          hostPort: 7070

crds:
  group: akri.sh
  version: v0